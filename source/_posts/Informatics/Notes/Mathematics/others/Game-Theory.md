---
title: 数学 - 博弈论
tags:
  - '[I] 数学'
categories:
  - Informatics
  - Notes
date: 2022-10-20 23:14:57
---


被安排的游戏——胜券在握与必败无疑

<!--more-->

## 简介

  > **博弈论**，是经济学的一个分支，主要研究具有竞争或对抗性质的对象，在一定规则下产生的各种行为。博弈论考虑游戏中的个体的预测行为和实际行为，并研究它们的优化策略。
  > 通俗地讲，博弈论主要研究的是：在一个游戏中，进行游戏的多位玩家的策略。（摘自 OI Wiki）

在 OI 中，博弈游戏研究的是必胜和必败，算是被安排的游戏。

## 公平组合游戏

这样的游戏我们称为公平组合游戏。

  1. 游戏由双方参与，交替进行，双方均可以知道游戏的完整信息。
  2. 每一步可作出的决策只与当前局面有关，而与决策者无关。
  3. 最后不能行动的一方落败

著名的巴什博弈，有一堆石子，双方轮流取走数量在 $[1,K]$ 以内的石子，最后不能取走石子的一方落败，就是一种公平组合游戏。而大多数的棋类游戏，如象棋、围棋，都是非公平组合游戏，因为双方只能移动自己的棋子。

对于巴什博弈，我们都知道当 $K+1\mid N$ 时先手必败，否则先手必胜。

## 有向图游戏

在公平组合游戏中，如果将每个游戏局面视作结点，对可以进行的转移连边，那么就生成了一张有向图。在游戏进行的过程中，实际上就是双方交替将一枚棋子沿着有向边移动，最后不能移动的落败，我们称这样的状态为终止状态。

我们将该状态以后，先手必胜的状态称为 N 态，将先手必败的状态称为 P 态。我们可以得出，一个状态为 N 态，当且仅当它的后继状态中存在 P 态；一个状态为 P 态，当且仅当它的后继状态全是 N 态；终止状态为 P 态。

{% asset_img digraph.png '"" "有向图游戏"' %}

当然，如果有向图存在环，并且从该环离开到达的任意状态均为 N 态，那么该有向图游戏将永远进行下去，没有必胜策略。

巴什博弈也可以用有向图表示。

{% asset_img bash.png '"" "巴什博弈"' %}

## Nim 游戏

Nim 游戏是一个公平组合游戏。它是这样描述的：有 $n$ 堆石子，每一堆 $a_i$ 个，双方轮流执行操作，每次可以选取其中一堆取走若干石子，最后不能取石子的落败。

我们可以用一个 $n$ 维向量 $[a_1\quad a_2\quad\ldots\quad a_n]$ 表示当前剩余石子状态。

Nim 游戏有一个优雅的算法，我们令 $s=a_1\oplus a_2\oplus\ldots\oplus a_n$，当前局面为 N 态，当且仅当 $s\leq 0$。

证明：显然终止状态 $s=0$。对于任意 $s\leq 0$ 的情况，假设 $s$ 的最高位为第 $k$ 位，那么一定有一个 $a_i$ 在第 $k$ 位上是 $1$。此时有 $a_i'=a_i\oplus s<a_i$，因此我们可以从第 $i$ 堆取走一定数量石子，使得其剩余石子数量变为 $a_i'=a_i\oplus s$，将状态变为 $s'=0$。对于任意 $s=0$ 的非终止状态，无论怎么取总会使 $s'\leq 0$。在游戏不断进行过程中，剩余数量不断减少，因此不会出现环。综上所述，可以得出 $s\leq 0$ 时为 N 态，$s=0$ 时为 P 态。

## SG 函数

我们考虑将 Nim 游戏推广至一般有向图游戏。定义状态 x 的 SG 函数

$$
g(x)=\begin{cases}
0 & x\text{ 为终止状态}\\\\
\operatorname{mex}(\\{g(y)\mid y\text{ 是 }x\text{   的后继状态}\\}) & \textbf{otherwise.}
\end{cases}
$$

其中 $\operatorname{mex}(S)$ 的参数 $S$ 为一个非负整数集，函数表示不在 $S$ 内的最小非负整数。

这看起来有点像之前关于 N 态 P 态的理论，因此可以很容易得到，$g(x)\leq 0$ 时为 N 态，$g(x)=0$ 时为 P 态。 

试想，我们要同时进行 $n$ 个这样的有向图游戏，双方轮流执行操作，每次需选择一个有向图游戏进行移动，试分析必胜与必败。

我们定义整个游戏的 SG 函数 $g=g_1\oplus g_2\oplus\ldots\oplus g_n$，与前文相似地，当前局面为 N 态，当且仅当 $g\leq 0$。

因为单个 SG 函数的定义基于 $\operatorname{mex}$ 函数，所以对于状态 $x$，对于任意 $h<g(x)$，一定可以达到一个状态，这个状态的 SG 函数值为 $h$。因此我们能够推广上文将 $a_i$ 变成 $a_i'\oplus s$ 的做法。

## 反常游戏

反常游戏与公平组合游戏唯一的区别在于，反常游戏最终不能移动的一方胜利，而非落败。对于反 Nim 游戏，我们有一种做法。

当前状态为 N 态当且仅当以下条件满足其一

  1. 所有堆的石子数都为 $1$ 且游戏的 SG 函数值为 0。
  2. 存在一堆的石子数大于 $1$ 且游戏的 SG 函数值不为 0。

这里的“所有堆”指的是所有石子数大于 $0$ 的堆。

首先考虑情况 A：所有堆的石子数都为 $1$ 且游戏的 SG 函数值为 0。此时每一方都能且仅能每一步取 $1$ 个石子，当 $SG=0$ 时为 N 态。

再考虑情况 B：存在一堆的石子数大于 $1$ 且游戏的 SG 函数值不为 0。

考虑情况 B1：仅存在一堆的石子数大于 $1$。此时游戏的 SG 函数值一定不为 0，我们将这一堆的石子视情况取到 $1$ 或 $0$ 即可达到情况 A。

考虑情况 B2：存在不止一堆的石子数大于 $1$。

情况 B2a：若游戏的 SG 函数值不为 $0$，一定可以转移到 SG 函数值等于 0 的情况，即情况 B2b。

情况 B2b：若游戏的 SG 函数值为 $0$，只能转移到 SG 函数值不等于 0 的情况，即情况 B2a 或情况 B1。

综上所述，命题得证。

## 尘埃落定的博弈

牛顿的机械论早已不能决定因果，今日的博弈论尚在必胜必败间纠缠。

这本是一场被剧本支配的博弈，每个人都是演员，一切事态的发展均皆已知。

这亦是一场变幻万千的博弈，我们不会知道历史的下一刻将会导向何方，只是在尽力地做好自己。
